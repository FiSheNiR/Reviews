https://github.com/FiSheNiR/Reviews/blob/main/DmitriyKuzinCurrencyReview.md

деплой: http://89.169.162.233:8080/currency-exchange/
гит: https://github.com/zux13/currency-exchange
[Рустем Галиулин]



## ХОРОШО

1. Весь функционал реализован по ТЗ
2. Обработаны крайние случаи при добавлении/измении обмена валют
3. Реализована валидация при создании валиюты

## Недостатки реализации

1. Необработана валидация добавления новой валюты:
- Можно создать валюты с несуществующим кодом пример: XUI, ZXC, DDD
- Нет валидации на описание валюты (можно сделать описание знаками или просто цифрами)
2. Деплой расположен по адресу http://89.169.162.233:8080/currency-exchange/ однако при обращении к http://89.169.162.233:8080/ простой пользователь может попасть на страницу томката лучше всего почитай как сделать доступ к сайту через http://89.169.162.233:8080/ (Подсказка ROOT)
3. Можжно обратиться к несуществующим эндпоинтам пример: http://89.169.162.233:8080/currency-exchange/123 Было бы неплохо если бы редиректило на страницу приложения или выкидывало кастомную страницу с ошибкой

## ЗАМЕЧАНИЯ/Возможности для улучшения

**1. Пакет Filter**

Хорошо:
- Используешь фильтр для обработки ответа сервера и ошибок. 
- Обработаны неожидаемые ошибки
- В целом пакет фильтр нравится

Замечания:
- ExceptionHandlingFilter метод doFilter выглядит очень громоздким я бы разбил его на подметоды например метод который бы приняимал в аргументы статус код ошибки и сразу бы отдавал ответ

**2. Пакет Dao**  

Хорошо:
- Хорошая реализация на мой взягляд одна из эталонных
- Используешь класс шаблона для определения логики методов записи в БД сами конкретные методы от этого выглядят очень чистыми
- Вынес сами SQL запросы в отдельные константы 
- Используешь Singleton это хорошо

Замечания:
- В классе JdbcTemplate я бы не бросал простые RuntimeException а тоже сделал бы кастомные например DatabaseException это повысит читаемость и улучшит работу с ошибками
- Было бы хорошо добавить к CurrencyDao и ExchangeRateDao привязку к интерфейсу например CrudDAO  в котором были бы описаны основные методы это снизит связанность и у тебя не будет жесткой привязанности к твоим конкретным реализациям например в сервисах ты сможешь использовать методы интерфейса и если реализация поменяется то все будет так же хорошо работать
- Не очень понимаю как у тебя реализовано подключение к БД то есть у тебя по сути при каждом запросе используется 1 только подключение это не очень хорошо и может вызвать блокировки или какой то запрос не будет обработан если они совершатся одновременно. Почитай про Connection пулы и в частности про HikariCP они как раз решают эту проблему
- Не очень понял зачем у тебя в JdbcTemplate в методе update возвращается инт но при этом в CurrencyDao и ExchangeRateDao в методах update это никак не используется а в методах delete затем возвращается boolean который далее не нашел как проверяется
- У тебя внутри пакета dao и внутри самого проекта есть пакет mapper. В целом они делают похожие вещи и надо разобраться с неймингом чтобы не было одинакового наименования пакетов

Задание со звездочкой:
- В классе JdbcTemplate можно рассмотреть использование интерфейса для вынесения общей логики передачи конекшена и исполенению SQL запроса

**3. Пакеты DTO и Entity**  
Замечания:
- Для чего используешь equalsAndHashCode в entity?
- Использование @Data из Lombok на классах-сущностях потенциально опасно - https://habr.com/ru/companies/haulmont/articles/564682/

**4. Пакет Mapper**  
Молодец что сам попробовал реализовать преобразование Dto  в сущности и наоборот но на будущее лучше использовать для этого библиотеки например ModelMapper

**5. Пакет Service**

Замечания:
- Класс ExchangeRateService выглядит перегруженным я бы разделил работу с курсами и бд и обмен на разные классы

**6. Пакет Validation**

Замечания:
- Хорошая кастомная валидация но для валидации кода валюты я бы воспользовался стандартным пакетом java.util.Currency

**7. Пакет Servlet**

Отличная реализация в сервлетах нет ничего лишнего (получаешь запрос + валидация + отдаешь ответ)


## ВЫВОД

Очень хорошая реализация тяжело было найти какие то недочеты. В моем понимании все написано по канонам. Продолжай и дальше делать проекты на таком уровне
Обрати внимание на библиотеки и модуль которые подсветил в ревью (Hikari, modelmapper)

#ревью #обмен_валют